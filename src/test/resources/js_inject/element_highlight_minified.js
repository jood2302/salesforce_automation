if(!window.NEODYMIUM){window.NEODYMIUM=new function(){function a(a,b){var c,d=a.ownerDocument;if(d&&d.defaultView&&d.defaultView.getComputedStyle){var e=d.defaultView.getComputedStyle(a,null);c=e?e.getPropertyValue(b):null}return"auto"===c?null:c}function b(c,d){var e=a(c,d);return"inherit"===e&&c.parentNode?b(c.parentNode,d):e}function c(b){for(b=b.parentNode;b&&1!=b.nodeType&&9!=b.nodeType&&11!=b.nodeType;)b=b.parentNode;return!b||1!==b.nodeType?null:b}function d(a){var b;if(1===a.nodeType&&"HTML"===a.tagName.toUpperCase())return a=a.ownerDocument,a="CSS1Compat"===a.compatMode?a.documentElement:a.body,{left:0,top:0,height:a.clientHeight,width:a.clientWidth,right:a.clientWidth,bottom:a.clientHeight};try{b=a.getBoundingClientRect()}catch(a){return{left:0,top:0,right:0,bottom:0,height:0,width:0}}return{left:b.left,top:b.top,width:b.right-b.left,height:b.bottom-b.top,right:b.right,bottom:b.bottom}}function e(a){var d=b(a,"display");return"none"!==d&&(a=c(a),!a||e(a))}function f(e){var g,h=d(e);if(0<h.height&&0<h.width)return!0;if(1===e.nodeType&&"PATH"===e.nodeName.toUpperCase()&&(0<h.height||0<h.width))return g=b(e,"stroke-width"),!!g&&0<parseInt(g,10);if("hidden"!=b(e,"overflow"))for(var j,k=e.childNodes,c=k.length,l=0;l<c;l++)if(j=k.item(l),3===j.nodeType||1===j.nodeType&&f(j))return!0;return!1}function g(a){function e(a){function d(a){if(a==m)return!0;var c=b(a,"display");return!/^inline/.test(c)&&("absolute"!==e||"static"!==b(a,"position"))}var e=b(a,"position");if("fixed"===e)return i=!0,a===m?null:m;for(var f=c(a);f&&!d(f);)f=c(f);return f}function f(a){var c=a;if("visible"===o)if(a===m&&n)c=n;else if(a==n)return{x:"visible",y:"visible"};var d={x:b(c,"overflow-x"),y:b(c,"overflow-y")};return a===m&&(d.x="visible"===d.x?"auto":d.x,d.y="visible"===d.y?"auto":d.y),d}function h(a){if(a===m){var b=l.scrollingElement||n||m,c=l.parentWindow||l.defaultView;return{x:c.pageXOffset||b.scrollLeft,y:c.pageYOffset||b.scrollTop}}return{x:a.scrollLeft,y:a.scrollTop}}for(var i,j,k=d(a),l=a.ownerDocument||a.document,m=l.documentElement,n=l.body,o=b(m,"overflow"),p=e(a);!!p;p=e(p))if(j=f(p),"visible"!==j.x||"visible"!==j.y){var q=d(p);if(0===q.width||0===q.height)return"hidden";var r=k.right<q.left,s=k.bottom<q.top;if(r&&"hidden"===j.x||s&&"hidden"===j.y)return"hidden";if(r&&"visible"!==j.x||s&&"visible"!==j.y){var t=h(p),u=k.right<q.left-t.x,v=k.bottom<q.top-t.y;if(u&&"visible"!==j.x||v&&"visible"!==j.x)return"hidden";var w=g(p);return"hidden"===w?w:"scroll"}var x=k.left>=q.left+q.width,y=k.top>=q.top+q.height;if(x&&"hidden"===j.x||y&&"hidden"===j.y)return"hidden";if(x&&"visible"!==j.x||y&&"visible"!==j.y){if(i){var z=h(p);if(k.left>=m.scrollWidth-z.x||k.right>=m.scrollHeight-z.y)return"hidden"}var w=g(p);return"hidden"===w?w:"scroll"}}return"none"}function h(a){var b,c=a&&a.ownerDocument,d=c&&c.documentElement,e={x:0,y:0,height:0,width:0,sx:0,sy:0};if(a)if(a===c.body)e.x=a.offsetLeft,e.y=a.offsetTop,e.height=a.offsetHeight,e.width=a.offsetWidth;else{try{b=a.getBoundingClientRect()}catch(a){}if(b){var f=c.body,g=c.defaultView,h=d.clientTop||f.clientTop||0,i=d.clientLeft||f.clientLeft||0,j=Math.round(g.scrollY)||d.scrollTop||f.scrollTop,k=Math.round(g.scrollX)||d.scrollLeft||f.scrollLeft;e.x=b.left+k-i,e.y=b.top+j-h,e.height=b.height,e.width=b.width,e.sx=k,e.sy=j}}return e}function j(a){function d(a){return"hidden"===g(a)&&Array.prototype.every.call(a.childNodes,function(a){return 1!==a.nodeType||d(a)||!f(a)})}if(!a)return!1;for(var h=a;h.parentNode&&1!==h.nodeType&&9!==h.nodeType;)h=h.parentNode;if(9===h.nodeType)return!0;switch(h.nodeName.toUpperCase()){case"BODY":return!0;case"META":case"SCRIPT":return!1;case"INPUT":if("hidden"===h.getAttribute("type"))return!1;break;case"A":if(0===h.childElementCount&&/^[ \f\n\r\t\v​\u1680​\u180e\u2000​\u2001\u2002​\u2003\u2004​\u2005\u2006​\u2008​\u2009\u200a​\u2028\u2029​\u205f​\u3000]*$/.test(h.textContent))return!1;break;case"OPTION":case"OPTGROUP":for(;(h=h.parentNode)&&(1!==h.nodeType||"SELECT"!==h.nodeName.toUpperCase()););return h&&j(h);case"BR":return h=c(h),h&&j(h);default:}return!!(!/^hidden|collapsed$/.test(b(h,"visibility"))&&e(h)&&f(h))&&!d(h)}function k(a){for(var b=a;b&&b.ownerDocument;){let a=h(b);l(b,a)||b.ownerDocument.defaultView.scrollTo(Math.max(a.x-10,0),Math.max(a.y-b.ownerDocument.defaultView.innerHeight/3,0)),b=b.ownerDocument.defaultView.frameElement}}function l(a,b){let c=!1;if(a&&a.ownerDocument){let d=a.ownerDocument.defaultView;d.scrollY<b.y&&d.innerHeight+d.scrollY>b.y&&d.scrollX<b.x&&d.innerWidth+d.scrollX>b.x&&(c=!0)}return c}switchHighlightStyle=function(a,b,c,d){["neodymium-highlight-box","neodymium-outline-box"].forEach(function(e){for(var f,g=a.getElementsByClassName(e),h=0;h<g.length;h++)f=g[h].getAttribute("style"),b?g[h].setAttribute("style",f.replace(d,c)):g[h].setAttribute("style",f.replace(c,d))})},highlightSingleElement=function(a,b,c,d,e){if(a&&!/^OPT(ION|GROUP)$/.test(a.nodeName.toUpperCase())){0===b&&k(a);var f=h(a),g=a.ownerDocument,i=g.createElement("div"),j=g.body,l="position:absolute; display:block; border-width:1px; border-style:solid; z-index: 9999; opacity: .75; top: "+f.y+"px; left: "+f.x+"px; width: "+a.offsetWidth+"px; height: "+a.offsetHeight+"px; background-color: "+d+"; border-color: blue;";!c||(l+=" font-size: 0.8em; padding-left: 2px; color: magenta; font-weight: bold;",i.textContent=b+1+""),i.setAttribute("style",l),e=e?" "+e:"",i.setAttribute("class","neodymium-highlight-box"+e),j.appendChild(i)}},outline=function(b,c){if(b&&c){var d=a(b,"background-color")||"",e=a(b,"outline")||"";"transparent"===d&&(d=""),b.style.backgroundColor=c,b.style.outline="1px solid blue",b.__origBG=d,b.__origOutline=e,b.__origClass=b.getAttribute("class");var f=b.__origClass||"";0>f.indexOf("neodymium-outline-box")&&(f+=" neodymium-outline-box"),b.setAttribute("class",f)}},this.highlightAllElements=function(a,b,c,d,e){var f=d?d:"rgb(255, 255, 90)",g=e?e:"rgb(255, 255, 210)";if(a&&0<a.length&&b){var h=260<c?250:c-10,l=1<a.length;let d=new Date().getTime();if(0<h){for(var m=!1,n=0;n<a.length;n++)/^FRAME(SET)?$/.test(a[n].localName.toUpperCase())?(outline(a[n],f),m=!0):j(a[n])&&(highlightSingleElement(a[n],n,l,f,d),m=!0);if(m){var o=this,p=0,q=window.setInterval(function(){switchHighlightStyle(b,0==p%2,f,g),p++},h),r=window.setTimeout(function(){o.resetHighlightElements(b,q,null,d)},c);return[q,r]}}else j(a[0])&&k(a[0])}return null},this.resetHighlightElements=function(a,b,c,d){b&&window.clearInterval(b),c&&window.clearTimeout(c);let f=d?d:"neodymium-highlight-box";for(var g=a.getElementsByClassName(f);0<g.length;){var h=g[0].ownerDocument.body;h.removeChild(g[0]),g=a.getElementsByClassName(f)}for(var j=a.getElementsByClassName("neodymium-outline-box"),k=0;k<j.length;k++){var l=j[k],e=l.__origClass;l.style.backgroundColor=l.__origBG||"",l.style.outline=l.__origOutline||"",e?l.setAttribute("class",e):l.removeAttribute("class"),l.__origBG=l.__origOutline=l.__origClass=null}}}}